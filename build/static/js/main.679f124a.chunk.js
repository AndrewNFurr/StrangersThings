(this.webpackJsonpstrangers_things=this.webpackJsonpstrangers_things||[]).push([[0],{17:function(e,t,n){"use strict";n.r(t);var s=n(9),r=n(2),c=n.n(r),a=n(4),o=n(8),i=n(3),u=n(0),l=n(1),j=n(10),b=n.n(j),d="https://strangers-things.herokuapp.com/api/2007-LSU-RM-WEB-PT",p=function(){return localStorage.getItem("auth-token")},h=function(e){localStorage.setItem("auth-token",e)};function O(){var e={"Content-Type":"application/json"};return p()&&(e.Authorization="Bearer ".concat(p())),e}var x=function(){var e=Object(a.a)(c.a.mark((function e(t,n){var s,r,a,o,i,u,l=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=l.length>2&&void 0!==l[2]&&l[2],r="".concat(d,"/users")+(s?"/register":"/login"),e.next=4,fetch(r,{method:"POST",headers:O(),body:JSON.stringify({user:{username:t,password:n}})});case 4:return a=e.sent,e.next=7,a.json();case 7:if(o=e.sent,i=o.error,u=o.data,!i){e.next=12;break}throw Error(i.message);case 12:return u&&u.token&&h(u.token),e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(a.a)(c.a.mark((function e(t,n,s){var r,a,o,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={method:t,headers:O()},s&&(r.body=JSON.stringify(s)),e.next=4,fetch("".concat(d).concat(n),r);case 4:return a=e.sent,e.next=7,a.json();case 7:if(o=e.sent,i=o.error,u=o.data,!i){e.next=12;break}throw Error(i.message);case 12:return u&&u.token&&h(u.token),e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)})));return function(t,n,s){return e.apply(this,arguments)}}(),g=function(e){var t=e.setIsLoggedIn,n=Object(l.useState)(""),s=Object(i.a)(n,2),r=s[0],o=s[1],j=Object(l.useState)(""),b=Object(i.a)(j,2),d=b[0],p=b[1],h=Object(l.useState)(null),O=Object(i.a)(h,2),f=O[0],g=O[1];return Object(u.jsxs)("form",{className:"login-form",onSubmit:function(e){return e.preventDefault()},children:[Object(u.jsx)("h3",{children:"Register or Log In"}),f?Object(u.jsx)("h5",{className:"error",children:f}):null,Object(u.jsx)("input",{type:"text",value:r,onChange:function(e){return o(e.target.value)},placeholder:"username"}),Object(u.jsx)("input",{type:"password",value:d,onChange:function(e){return p(e.target.value)},placeholder:"password"}),Object(u.jsx)("button",{onClick:Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x(r,d,!0);case 3:t(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),g(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),children:"Register"}),Object(u.jsx)("button",{onClick:Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x(r,d);case 3:t(!0),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),g(e.t0.message);case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),children:"Log In"})]})},v=function(e){var t=e.isLoggedIn,n=e.setIsLoggedIn,s=e.setPostList,r=e.setUserPostsOnly,c=e.postList;return Object(u.jsx)("div",{id:"header",children:t?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Welcome to Stranger's Things!"}),Object(u.jsx)("button",{onClick:function(){localStorage.removeItem("auth-token"),n(!1),r(!1)},children:"LOG OUT"})]}):Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"Stranger's Things"}),Object(u.jsx)(g,{setIsLoggedIn:n,postList:c,setPostList:s,isLoggedIn:t})]})})},m=function(e){var t=e.addNewPost,n=e._id,s=e.setEditablePost,r=e.updatePost,o=Object(l.useState)(""),j=Object(i.a)(o,2),b=j[0],d=j[1],p=Object(l.useState)(""),h=Object(i.a)(p,2),O=h[0],x=h[1],g=Object(l.useState)(""),v=Object(i.a)(g,2),m=v[0],k=v[1],w=Object(l.useState)(""),S=Object(i.a)(w,2),y=S[0],L=S[1],P=Object(l.useState)(!1),C=Object(i.a)(P,2),I=C[0],E=C[1],N=Object(l.useState)(!1),T=Object(i.a)(N,2),F=T[0],_=T[1];return Object(l.useEffect)((function(){d(e.title||""),x(e.description||""),k(e.price||""),L(e.location||"")}),[n]),Object(u.jsxs)("form",{className:"post-form",onSubmit:function(){var e=Object(a.a)(c.a.mark((function e(a){var o,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),0!==b.length){e.next=4;break}return _(!0),e.abrupt("return");case 4:if(o={post:{title:b,description:O,price:m,willDeliver:I}},y.length>0&&(o.post.location=y),!n){e.next=20;break}return e.prev=7,e.next=10,f("PATCH","/posts/".concat(n),o);case 10:i=e.sent,r(i.post),s({}),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(7),console.error(e.t0);case 18:e.next=30;break;case 20:return e.prev=20,e.next=23,f("POST","/posts",o);case 23:u=e.sent,t(u.post),e.next=30;break;case 27:e.prev=27,e.t1=e.catch(20),console.error(e.t1);case 30:d(""),x(""),k(""),L("");case 31:case"end":return e.stop()}}),e,null,[[7,15],[20,27]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(u.jsx)("h3",{children:"Build Post"}),Object(u.jsx)("input",{type:"text",placeholder:"title for your post",value:b,onChange:function(e){return d(e.target.value)}}),F&&0===b.length?Object(u.jsx)("h3",{style:{color:"red"},children:"You need a title"}):null,Object(u.jsx)("textarea",{type:"text",placeholder:"description",rows:"10",columns:"80",value:O,onChange:function(e){return x(e.target.value)}}),Object(u.jsx)("input",{type:"text",placeholder:"price",value:m,onChange:function(e){return k(e.target.value)}}),Object(u.jsx)("input",{type:"text",placeholder:"location",value:y,onChange:function(e){return L(e.target.value)}}),Object(u.jsxs)("label",{children:[Object(u.jsx)("input",{type:"checkbox",checked:I,onChange:function(){return E(!I)}}),"I will deliver this"]}),Object(u.jsx)("button",{children:"POST"})]})},k=function(e){var t=e.handleClick,n=Object(l.useState)(""),s=Object(i.a)(n,2),r=s[0],c=s[1];return Object(u.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(u.jsx)("input",{type:"text",value:r,onChange:function(e){c(e.target.value)},placeholder:"Message to Author"}),Object(u.jsx)("button",{onClick:function(){t(r),c("")},children:"Post Message"})]})},w=function(e){var t=e.messageList,n=Object(l.useState)(!1),s=Object(i.a)(n,2),r=s[0],c=s[1];return Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("button",{onClick:function(){c(!r)},children:"Messages"}),r?t.map((function(e,t){return Object(u.jsxs)("div",{style:{border:"2px solid tan",margin:"2px"},children:[Object(u.jsxs)("p",{children:["From: ",e.fromUser.username]},t),Object(u.jsx)("p",{children:e.content})]})})):null]})},S=function(e){var t=e.postList,n=e.setPostList,s=e.setEditablePost,r=e.isLoggedIn,o=e.userPostsOnly;return Object(u.jsxs)("div",{className:"post-view",children:[Object(u.jsx)("h1",{children:o?"User Posts":"All Posts"}),Object(u.jsx)("div",{className:"list",children:t.map((function(e){return Object(u.jsxs)("div",{className:"post",style:{border:e.isAuthor?"5px solid olive":"3px solid orange"},children:[Object(u.jsxs)("h5",{children:[e.title," (",e.location,")"]}),Object(u.jsx)("p",{children:Object(u.jsxs)("strong",{children:["Price: ",e.price]})}),Object(u.jsxs)("p",{children:[" Will deliver: ",e.willDeliver?"Yes":"No"]}),Object(u.jsx)("p",{children:Object(u.jsx)("em",{children:e.description})}),r?e.isAuthor?Object(u.jsxs)("div",{className:"user-options",children:[Object(u.jsx)("button",{onClick:Object(a.a)(c.a.mark((function t(){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f("DELETE","/posts/".concat(e._id));case 3:s=t.sent,n(s.posts),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),children:"Delete"}),Object(u.jsx)("button",{onClick:function(){s(e)},children:"Edit"}),Object(u.jsx)(w,{messageList:e.messages})]}):Object(u.jsx)("div",{className:"user-options",children:Object(u.jsx)(k,{handleClick:function(){var t=Object(a.a)(c.a.mark((function t(n){var s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s={message:{content:n}};try{f("POST","/posts/".concat(e._id,"/messages"),s)}catch(r){console.error(r)}case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()})}):null]},e._id)}))})," "]})},y=function(){var e=Object(l.useState)(!!p()),t=Object(i.a)(e,2),n=t[0],r=t[1],j=Object(l.useState)([]),b=Object(i.a)(j,2),d=b[0],h=b[1],O=Object(l.useState)(""),x=Object(i.a)(O,2),g=(x[0],x[1]),k=Object(l.useState)(""),w=Object(i.a)(k,2),y=w[0],L=w[1],P=Object(l.useState)({}),C=Object(i.a)(P,2),I=C[0],E=C[1],N=Object(l.useState)(!1),T=Object(i.a)(N,2),F=T[0],_=T[1];function A(){return F?d.filter((function(e){return e.isAuthor&&e.title.toLowerCase().includes(y.toLowerCase())})):d.filter((function(e){return e.title.toLowerCase().includes(y.toLowerCase())}))}var U=function(){return d.map((function(e){return e.isAuthor?Object(u.jsxs)("div",{className:"post",style:{border:"5px solid olive"},children:[Object(u.jsxs)("h3",{children:["For: ",e.title]}),e.messages.map((function(e,t){return Object(u.jsxs)("div",{style:{border:"2px solid tan",margin:"2px"},children:[Object(u.jsxs)("p",{children:["From: ",e.fromUser.username]},t),Object(u.jsx)("p",{children:e.content})]})}))]},e._id):null}))};return Object(l.useEffect)(Object(a.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f("GET","/posts").then((function(e){var t=e.posts;h(t)})).catch(console.error);case 1:case"end":return e.stop()}}),e)}))),[n,d]),Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)(v,{isLoggedIn:n,setIsLoggedIn:r,setPostList:h,postList:A(),setUserPostsOnly:_}),Object(u.jsxs)("div",{id:"search",children:[Object(u.jsx)("label",{htmlFor:"keywords",children:"Search For a Post"}),Object(u.jsx)("input",{id:"keywords",type:"text",placeholder:"Enter Post Title",value:y,onChange:function(e){L(e.target.value)}}),n?F?Object(u.jsx)("button",{onClick:function(){_(!F)},children:"Show all posts"}):Object(u.jsx)("button",{onClick:function(){_(!F)},children:"Show user posts/messages"}):null]}),Object(u.jsxs)("div",{className:"logged-in-view",children:[Object(u.jsx)("div",{children:F?Object(u.jsxs)(u.Fragment,{children:[Object(u.jsx)("h1",{children:"User Messages"}),Object(u.jsx)(U,{})]}):null}),Object(u.jsx)(S,{setSearchResults:g,postList:A(),setEditablePost:E,setPostList:h,isLoggedIn:n,userPostsOnly:F}),n?Object(u.jsx)(m,Object(s.a)(Object(s.a)({addNewPost:function(e){h([].concat(Object(o.a)(d),[e]))}},I),{},{setEditablePost:E,updatePost:function(e){var t=d.findIndex((function(t){return t._id===e._id}));if(t>-1){var n=Object(o.a)(d);n[t]=e,h(n)}}})):null]})]})};b.a.render(Object(u.jsx)(y,{}),document.getElementById("app"))}},[[17,1,2]]]);
//# sourceMappingURL=main.679f124a.chunk.js.map